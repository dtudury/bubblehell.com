{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","node_modules/browserify/node_modules/events/events.js","bundle.js","src/Complex.js","src/EquationSolver.js","src/Line.js","src/MovingThings.js","src/Overlaps.js","src/Point.js","src/Quad.js","src/QuadTree.js","src/RoundThing.js","src/Thing.js","src/controller/DoubleJoystick.js","src/controller/KeyboardControl.js","src/controller/MouseControl.js","src/controller/MouseLock.js","src/controller/QuadTreeDebug.js","src/index.js","src/model/World.js","src/view/Board.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","EventEmitter","this","_events","_maxListeners","undefined","isFunction","arg","isNumber","isObject","isUndefined","prototype","defaultMaxListeners","setMaxListeners","isNaN","TypeError","emit","type","er","handler","len","args","listeners","error","arguments","Array","slice","apply","addListener","listener","m","newListener","push","warned","console","trace","on","once","g","removeListener","fired","list","position","splice","removeAllListeners","key","ret","listenerCount","evlistener","emitter",2,"_classCallCheck","instance","Constructor","_abs","v","Complex","Math","sqrt","_add","b","_div","d","_mul","_neg","_sqrt","c","_sign","_sub","Object","defineProperty","value","_typeof","Symbol","iterator","obj","constructor","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","protoProps","staticProps","sign","x","convert","parseFloat","sqrt_radius","pow","half_theta","atan2","cos","sin",3,"_interopRequireDefault","__esModule","default","_cube_root","abs","_linear","complex","C","_quadratic","_cubic","a2","a3","b2","b3","g2","h","h1_2","real","imaginary","_sqrt3","j","k","acos","p","_quartic","b4","y","sort","q","div","mul","add","sub","neg","filter","map","_solve","coefficients","co","shift","solutions","pop","concat","solve","linear","quadratic","cubic","quartic","_Complex","_Complex2","./Complex.js",4,"_Point","Line","p1","p2","line","dx","dy","./Point",5,"_interopRequireWildcard","newObj","hasOwnProperty","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","setPrototypeOf","__proto__","points_to_lines","points","lines","forEach","i1","i2","_Line2","predict_collisions","thing","shape","collisions","_Point2","normalize","get_normals","n_dot_p","dot","ddx","ddy","dts","_EquationSolver","dt","normal","predict_collisions2","ddz","dz","predict_quad_collisions","quads_set","quad","naive_collisions","_predict_all_collisions","room_collisions","box","diamond_collisions","diamond","quad_collisions","_get","get","object","property","receiver","Function","desc","getOwnPropertyDescriptor","parent","getPrototypeOf","getter","_QuadTree2","_QuadTree3","_Line","_Overlaps","Overlaps","Map","MovingThings","_QuadTree","width","height","capacity","max_levels","_this","max","Date","now","court_width","court_height","_this2","_loop","next_collision","remove","clone_at_t","v_dot_n","scale","collision","all_collisions","from","all_things","found_thing","quad_and_point","my_things","thing_now","circle_and_point","children","child","get_thing_at","./EquationSolver","./Line","./Overlaps.js","./QuadTree",6,"quad_and_quad","left","right","top","bottom","quad_and_circle","r2","distance_squared","tl","tr","bl","br","circle_and_circle","./Point.js",7,"Point",8,"Quad",9,"_Quad2","_Quad3","QuadTree","_Quad","size","Set","touch","has","touch_things","split","remove_from_children","_this3","half_size","qt","./Quad.js",10,"_Thing2","_Thing3","RoundThing","_Thing","color","clone","w","random","angle","PI","speed","angle2","acceleration","./Thing.js",11,"Thing","dt2","touched","color_cycle","color_index","floor",12,"_defineProperty","calculate_arrow","MOVE","_ref","_","_2","_atrig2","_events2","_KeyboardControl","KeyboardControl","_MouseControl","MouseControl","_MouseLock","MouseLock","_trig",0,"SQRT1_2","_locked","_micro_angle","mangle","kangle","CHORD","chord","ts","up","down","LOCKED","UNLOCKED","./KeyboardControl.js","./MouseControl.js","./MouseLock.js","events",13,"update_direction","state","keyCode","window","event","_set","timeStamp","addEventListener",14,"document","movementX","mozMovementX","movementY","mozMovementY",15,"get_pointerLockElement","pointerLockElement","mozPointerLockElement","webkitPointerLockElement","update_pointerlock","element","unlocked","set","event_name","requestPointerLock",16,"board","reverse_map","_World","movingThings","_RoundThing2","get_thing_at_t","_RoundThing","../RoundThing.js","../model/World.js",17,"_Board","_Board2","_QuadTreeDebug","_QuadTreeDebug2","onload","handle_resize","_canvas","innerWidth","innerHeight","_board","resize","createElement","getContext","alert","body","appendChild","./controller/MouseLock.js","./controller/QuadTreeDebug.js","./view/Board.js",18,"_MovingThings","_MovingThings2","_DoubleJoystick","DoubleJoystick","log","no_collision","../MovingThings.js","../Overlaps.js","../controller/DoubleJoystick.js",19,"_SCALE","last_time","Board","context","vwidth","vheight","inner","redraw_loop","redraw","requestAnimationFrame","windowWidth","windowHeight","inner_ratio","outer_ratio","min","things","get_things_at_t","clearRect","lineWidth","draw_quadtree","quadtree","middle","beginPath","moveTo","lineTo","stroke","strokeStyle","strokeRect","untouch","arc","neighbors","neighbor","origin","reverse_scale","../Quad.js"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      }\n      throw TypeError('Uncaught, unspecified \"error\" event.');\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      }\n      throw TypeError('Uncaught, unspecified \"error\" event.');\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n},{}],2:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar _sign = Math.sign || function (x) {\n    return x && x > 0 ? 1 : -1;\n};\n\nvar Complex = function () {\n    function Complex() {\n        var r = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];\n        var i = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n\n        _classCallCheck(this, Complex);\n\n        this.r = r;\n        this.i = i;\n    }\n\n    _createClass(Complex, [{\n        key: \"abs\",\n        value: function abs() {\n            return _abs(this);\n        }\n    }, {\n        key: \"add\",\n        value: function add(v) {\n            return _add(this, Complex.convert(v));\n        }\n    }, {\n        key: \"div\",\n        value: function div(v) {\n            return _div(this, Complex.convert(v));\n        }\n    }, {\n        key: \"mul\",\n        value: function mul(v) {\n            return _mul(this, Complex.convert(v));\n        }\n    }, {\n        key: \"neg\",\n        value: function neg() {\n            return _neg(this);\n        }\n    }, {\n        key: \"sqrt\",\n        value: function sqrt() {\n            return _sqrt(this);\n        }\n    }, {\n        key: \"sub\",\n        value: function sub(v) {\n            return _sub(this, Complex.convert(v));\n        }\n    }], [{\n        key: \"convert\",\n        value: function convert(v) {\n            var i = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n            //can also pass r, i\n            if (v) {\n                var type = typeof v === \"undefined\" ? \"undefined\" : _typeof(v);\n                if (type === \"number\") return new Complex(v, i);\n                //no good reason to pass imaginary part at this point\n                if (type === \"object\") return new Complex(typeof v.r === \"number\" ? v.r : parseFloat(v.r) || 0, typeof v.i === \"number\" ? v.i : parseFloat(v.i) || 0);\n            }\n            return new Complex(0, i);\n        }\n    }, {\n        key: \"abs\",\n        value: function abs() {\n            var v = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];\n            var i = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n            //can also pass r, i\n            return _abs(Complex.convert(v, i));\n        }\n    }, {\n        key: \"add\",\n        value: function add(a, b) {\n            return _add(Complex.convert(a), Complex.convert(b));\n        }\n    }, {\n        key: \"div\",\n        value: function div(a, b) {\n            return _div(Complex.convert(a), Complex.convert(b));\n        }\n    }, {\n        key: \"mul\",\n        value: function mul(a, b) {\n            return _mul(Complex.convert(a), Complex.convert(b));\n        }\n    }, {\n        key: \"neg\",\n        value: function neg() {\n            var v = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];\n            var i = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n            //can also pass r, i\n            return _neg(Complex.convert(v, i));\n        }\n    }, {\n        key: \"sqrt\",\n        value: function sqrt() {\n            var v = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];\n            var i = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n            //can also pass r, i\n            return _sqrt(Complex.convert(v, i));\n        }\n    }, {\n        key: \"sub\",\n        value: function sub(a, b) {\n            return _sub(Complex.convert(a), Complex.convert(b));\n        }\n\n        //slower, just here for testing\n\n    }, {\n        key: \"sqrt2\",\n        value: function sqrt2() {\n            var r = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];\n            var i = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n\n            var sqrt_radius = Math.pow(r * r + i * i, 0.25);\n            var half_theta = Math.atan2(i, r) / 2;\n\n            var a = Math.cos(half_theta) * sqrt_radius;\n            var b = Math.sin(half_theta) * sqrt_radius;\n            return new Complex(a, b);\n        }\n    }]);\n\n    return Complex;\n}();\n\nfunction _abs(v) {\n    return new Complex(Math.sqrt(v.r * v.r + v.i * v.i), 0);\n}\n\nfunction _add(a, b) {\n    return new Complex(a.r + b.r, a.i + b.i);\n}\n\nfunction _div(a, b) {\n    var d = b.r * b.r + b.i * b.i;\n    return new Complex((a.r * b.r + a.i * b.i) / d, (a.i * b.r - a.r * b.i) / d);\n}\n\nfunction _mul(a, b) {\n    return new Complex(a.r * b.r - a.i * b.i, a.r * b.i + a.i * b.r);\n}\n\nfunction _neg(v) {\n    return new Complex(-v.r, -v.i);\n}\n\nfunction _sqrt(v) {\n    if (!v.i) {\n        if (v.r < 0) return new Complex(0, Math.sqrt(-v.r));else return new Complex(Math.sqrt(v.r), 0);\n    }\n    var a = _abs(v).r / 2;\n    var b = v.r / 2;\n    var c = Math.sqrt(a + b);\n    var d = _sign(v.i) * Math.sqrt(a - b);\n    return new Complex(c, d);\n}\n\nfunction _sub(a, b) {\n    return new Complex(a.r - b.r, a.i - b.i);\n}\n\nexports.default = Complex;\n\n},{}],3:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.solve = solve;\nexports.linear = linear;\nexports.quadratic = quadratic;\nexports.cubic = cubic;\nexports.quartic = quartic;\n\nvar _Complex = require(\"./Complex.js\");\n\nvar _Complex2 = _interopRequireDefault(_Complex);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar C = _Complex2.default.convert;\n\nvar _sign = Math.sign || function (x) {\n    return x && x > 0 ? 1 : -1;\n};\n\nvar _sqrt3 = Math.sqrt(3);\n\nfunction _cube_root(v) {\n    return _sign(v) * Math.pow(Math.abs(v), 1 / 3);\n}\n\nfunction _linear(a, b, complex) {\n    if (complex) return [C(-b / a)];else return [-b / a];\n}\n\nfunction _quadratic(a, b, c, complex) {\n    // (-b +- sqrt(b^2 - 4ac)) / 2a\n    var d = 2 * a;\n    var e = b * b - 4 * a * c;\n    var f = b / d;\n    var g = Math.sqrt(Math.abs(e)) / d;\n    if (complex) {\n        if (e < 0) return [C(-f, g), C(-f, -g)];\n        return [C(-f - g), C(-f + g)];\n    } else {\n        if (e < 0) return [];\n        return [-f - g, -f + g];\n    }\n}\n\nfunction _cubic(a, b, c, d, complex) {\n    var a2 = a * a;\n    var a3 = a2 * a;\n    var b2 = b * b;\n    var b3 = b2 * b;\n    var f = (3 * c / a - b2 / a2) / 3;\n    var g = (2 * b3 / a3 - 9 * b * c / a2 + 27 * d / a) / 27;\n    var g2 = g * g;\n    var h = g2 / 4 + f * f * f / 27;\n    if (h > 0) {\n        var h1_2 = Math.sqrt(h);\n        var r = -g / 2 + h1_2;\n        var s = _cube_root(r);\n        var t = -g / 2 - h1_2;\n        var u = _cube_root(t);\n        if (complex) {\n            var real = (s + u) / 2 - b / (3 * a);\n            var imaginary = (s - u) * _sqrt3 / 2;\n            return [C(s + u - b / (3 * a)), C(real, imaginary), C(real, -imaginary)];\n        } else {\n            return [s + u - b / (3 * a)];\n        }\n    } else if (h === 0 && f === 0 && g === 0) {\n        if (complex) return [C(-_cube_root(d / a))];else return [-_cube_root(d / a)];\n    } else {\n        var i = Math.sqrt(g2 / 4 - h);\n        var j = _cube_root(i);\n        var k = Math.acos(-g / (2 * i));\n        var m = Math.cos(k / 3);\n        var n = _sqrt3 * Math.sin(k / 3);\n        var p = -b / (3 * a);\n        if (complex) {\n            return [C(-j * (m - n) + p), C(-j * (m + n) + p), C(2 * j * Math.cos(k / 3) - b / (3 * a))];\n        } else {\n            return [-j * (m - n) + p, -j * (m + n) + p, 2 * j * Math.cos(k / 3) - b / (3 * a)];\n        }\n    }\n}\n\nfunction _quartic(a, b, c, d, e, complex) {\n    b /= a;\n    c /= a;\n    d /= a;\n    e /= a;\n    var b2 = b * b;\n    var f = c - 3 * b2 / 8;\n    var b3 = b2 * b;\n    var g = d + b3 / 8 - b * c / 2;\n    var b4 = b3 * b;\n    var h = e - 3 * b4 / 256 + b2 * c / 16 - b * d / 4;\n    var y = _cubic(1, f / 2, (f * f - 4 * h) / 16, -g * g / 64, true);\n    y.sort(function (a, b) {\n        return b.i - a.i || b.r - a.r;\n    });\n    var p = y[0].sqrt();\n    var q = y[1].sqrt();\n    var r = C(-g).div(p.mul(q).mul(8));\n    var s = C(b / 4);\n    var x = [p.add(q).add(r).sub(s), p.sub(q).sub(r).sub(s), p.neg().add(q).sub(r).sub(s), p.neg().sub(q).add(r).sub(s)];\n    if (complex) {\n        return x;\n    } else {\n        return x.filter(function (v) {\n            return !v.i;\n        }).map(function (v) {\n            return v.r;\n        });\n    }\n}\n\nfunction _solve(coefficients) {\n    var complex = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];\n\n    var co = coefficients.slice();\n    while (co.length && !co[0]) {\n        co.shift();\n    }var solutions = [];\n    if (!co.length) return solutions;\n    if (!co[co.length - 1]) {\n        if (complex) solutions.push(C(0));else solutions.push(0);\n        while (!co[co.length - 1]) {\n            co.pop();\n        }\n    }\n    if (co.length < 2) return solutions;\n    var a = co[0];\n    var b = co[1];\n    if (co.length === 2) return _linear(a, b, complex).concat(solutions);\n    var c = co[2];\n    if (co.length === 3) return _quadratic(a, b, c, complex).concat(solutions);\n    var d = co[3];\n    if (co.length === 4) return _cubic(a, b, c, d, complex).concat(solutions);\n    var e = co[4];\n    if (co.length === 5) return _quartic(a, b, c, d, e, complex).concat(solutions);\n\n    return \"unhandled polynomic order\";\n}\n\nfunction solve(coefficients) {\n    var complex = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];\n\n    if (complex) return _solve(coefficients, complex).sort(function (a, b) {\n        return a.r - b.r || a.i - b.i;\n    });else return _solve(coefficients, complex).sort(function (a, b) {\n        return a - b;\n    });\n}\n\nfunction linear(a, b) {\n    var complex = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\n    return solve([a, b], complex);\n}\n\nfunction quadratic(a, b, c) {\n    var complex = arguments.length <= 3 || arguments[3] === undefined ? false : arguments[3];\n\n    return solve([a, b, c], complex);\n}\n\nfunction cubic(a, b, c, d) {\n    var complex = arguments.length <= 4 || arguments[4] === undefined ? false : arguments[4];\n\n    return solve([a, b, c, d], complex);\n}\n\nfunction quartic(a, b, c, d, e) {\n    var complex = arguments.length <= 5 || arguments[5] === undefined ? false : arguments[5];\n\n    return solve([a, b, c, d, e], complex);\n}\n\n},{\"./Complex.js\":2}],4:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Point = require(\"./Point\");\n\nvar _Point2 = _interopRequireDefault(_Point);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Line = function () {\n    function Line(p1, p2) {\n        _classCallCheck(this, Line);\n\n        this.p1 = p1;\n        this.p2 = p2;\n    }\n\n    _createClass(Line, null, [{\n        key: \"get_normals\",\n        value: function get_normals(line) {\n            var dx = line.p2.x - line.p1.x;\n            var dy = line.p2.y - line.p1.y;\n            return [{ x: -dy, y: dx }, //right side first\n            { x: dy, y: -dx }];\n        }\n    }]);\n\n    return Line;\n}();\n\nexports.default = Line;\n\n},{\"./Point\":7}],5:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _QuadTree2 = require(\"./QuadTree\");\n\nvar _QuadTree3 = _interopRequireDefault(_QuadTree2);\n\nvar _EquationSolver = require(\"./EquationSolver\");\n\nvar _Point = require(\"./Point\");\n\nvar _Point2 = _interopRequireDefault(_Point);\n\nvar _Line = require(\"./Line\");\n\nvar _Line2 = _interopRequireDefault(_Line);\n\nvar _Overlaps = require(\"./Overlaps.js\");\n\nvar Overlaps = _interopRequireWildcard(_Overlaps);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _collisions_by_things = new Map();\n\nfunction points_to_lines(points) {\n    var lines = [];\n    points.forEach(function (p1, i1) {\n        var i2 = (i1 + 1) % points.length;\n        var p2 = points[i2];\n        lines.push(new _Line2.default(p1, p2));\n    });\n    return lines;\n}\n\nvar box = [{ x: -0.1, y: -0.1 }, { x: 400.1, y: -0.1 }, { x: 400.1, y: 300.1 }, { x: -0.1, y: 300.1 }];\nbox = points_to_lines(box);\nvar diamond = [{ x: 200, y: -50 }, { x: 400, y: 150 }, { x: 200, y: 350 }, { x: 0, y: 150 }];\ndiamond = points_to_lines(diamond);\n\nfunction predict_collisions(thing, shape) {\n    var collisions = [];\n    shape.forEach(function (line) {\n        var n = _Point2.default.normalize(_Line2.default.get_normals(line)[0]);\n        var n_dot_p = _Point2.default.dot(n, new _Point2.default(thing.x - line.p1.x, thing.y - line.p1.y));\n        if (n_dot_p < 0) return;\n\n        var coefficients = [_Point2.default.dot(n, new _Point2.default(thing.ddx, thing.ddy)) / 2, _Point2.default.dot(n, new _Point2.default(thing.dx, thing.dy)), n_dot_p - thing.r];\n        var dts = (0, _EquationSolver.solve)(coefficients);\n        dts.forEach(function (dt) {\n            if (dt <= 0) return;\n            collisions.push({\n                thing: thing,\n                normal: n,\n                t: thing.t + dt\n            });\n        });\n    });\n    return collisions;\n}\n\nfunction predict_collisions2(thing, shape) {\n    var collisions = [];\n    shape.forEach(function (line) {\n        var n = _Point2.default.normalize(_Line2.default.get_normals(line)[0]);\n        var n_dot_p = _Point2.default.dot(n, new _Point2.default(thing.x - line.p1.x, thing.y - line.p1.y));\n        //if (n_dot_p < 0) return;\n\n        var ddz = _Point2.default.dot(n, new _Point2.default(thing.ddx, thing.ddy)) / 2;\n        var dz = _Point2.default.dot(n, new _Point2.default(thing.dx, thing.dy));\n        var dts = [].concat((0, _EquationSolver.solve)([ddz, dz, n_dot_p - thing.r]), (0, _EquationSolver.solve)([ddz, dz, n_dot_p + thing.r]));\n        dts.forEach(function (dt) {\n            if (dt <= 0) return;\n            collisions.push({\n                thing: thing,\n                normal: n,\n                t: thing.t + dt\n            });\n        });\n    });\n    return collisions;\n}\n\nfunction predict_quad_collisions(thing) {\n    var collisions = [];\n    thing.quads_set.forEach(function (quad) {\n        var shape = points_to_lines(quad.points);\n        var naive_collisions = predict_collisions2(thing, shape);\n        naive_collisions.forEach(function (c) {\n            return delete c.normal;\n        });\n        collisions = collisions.concat(naive_collisions);\n    });\n    return collisions;\n}\n\nfunction _predict_all_collisions(thing) {\n    var room_collisions = predict_collisions(thing, box);\n    var diamond_collisions = predict_collisions(thing, diamond);\n    var quad_collisions = predict_quad_collisions(thing);\n    return [].concat(room_collisions, diamond_collisions, quad_collisions);\n}\n\nvar MovingThings = function (_QuadTree) {\n    _inherits(MovingThings, _QuadTree);\n\n    function MovingThings(t) {\n        var x = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n        var y = arguments.length <= 2 || arguments[2] === undefined ? 0 : arguments[2];\n        var width = arguments.length <= 3 || arguments[3] === undefined ? 400 : arguments[3];\n        var height = arguments.length <= 4 || arguments[4] === undefined ? 300 : arguments[4];\n        var capacity = arguments.length <= 5 || arguments[5] === undefined ? 2 : arguments[5];\n        var max_levels = arguments.length <= 6 || arguments[6] === undefined ? 5 : arguments[6];\n\n        _classCallCheck(this, MovingThings);\n\n        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(MovingThings).call(this, x, y, Math.max(width, height), capacity, max_levels));\n\n        _this.t = t === undefined ? Date.now() : t;\n        _this.court_width = width;\n        _this.court_height = height;\n        _this.collisions = [];\n        return _this;\n    }\n\n    _createClass(MovingThings, [{\n        key: \"get_things_at_t\",\n        value: function get_things_at_t(t) {\n            var _this2 = this;\n\n            var _loop = function _loop() {\n                var next_collision = _this2.collisions.shift();\n                var n = next_collision.normal;\n                _this2.remove(next_collision.thing);\n                var thing = next_collision.thing.clone_at_t(next_collision.t);\n                if (n) {\n                    var v = new _Point2.default(thing.dx, thing.dy);\n                    var v_dot_n = _Point2.default.dot(v, n);\n                    var r = _Point2.default.add(_Point2.default.scale(n, v_dot_n * -2), v);\n                    thing.dy = r.y;\n                    thing.dx = r.x;\n                }\n                _get(Object.getPrototypeOf(MovingThings.prototype), \"add\", _this2).call(_this2, thing);\n                if (_this2.thing === next_collision.thing) _this2.thing = thing;\n                _this2.collisions = _this2.collisions.filter(function (collision) {\n                    return collision.thing !== next_collision.thing;\n                });\n                var all_collisions = _predict_all_collisions(thing);\n                all_collisions = all_collisions.filter(function (collision) {\n                    return collision.t > next_collision.t;\n                });\n                _this2.collisions = _this2.collisions.concat(all_collisions);\n                _this2.collisions.sort(function (a, b) {\n                    return a.t - b.t;\n                });\n            };\n\n            while (this.collisions.length && this.collisions[0].t < t) {\n                _loop();\n            }\n            this.t = t;\n            /*\n            let temp = Array.from(this.all_things);\n            temp.forEach(thing => this.remove(thing));\n            this.collisions = [];\n            temp.forEach(thing => this.add(thing.clone_at_t(t)));\n            */\n            return Array.from(this.all_things).map(function (thing) {\n                return thing.clone_at_t(t);\n            });\n        }\n    }, {\n        key: \"add\",\n        value: function add(thing) {\n            if (!_get(Object.getPrototypeOf(MovingThings.prototype), \"add\", this).call(this, thing)) return false;\n            var all_collisions = _predict_all_collisions(thing);\n            this.collisions = this.collisions.concat(all_collisions);\n            this.collisions.sort(function (a, b) {\n                return a.t - b.t;\n            });\n            return true;\n        }\n    }, {\n        key: \"get_thing_at_t\",\n        value: function get_thing_at_t(x, y, t) {\n            var p = { x: x, y: y };\n            var found_thing = null;\n            if (!Overlaps.quad_and_point(this, p)) return null;\n            if (this.my_things) {\n                this.my_things.forEach(function (thing) {\n                    var thing_now = thing.clone_at_t(t);\n                    if (Overlaps.circle_and_point(thing_now, p)) found_thing = thing;\n                });\n                return found_thing;\n            }\n            this.children.forEach(function (child) {\n                return found_thing = found_thing || child.get_thing_at(x, y);\n            });\n            return found_thing;\n        }\n    }]);\n\n    return MovingThings;\n}(_QuadTree3.default);\n\nexports.default = MovingThings;\n\n},{\"./EquationSolver\":3,\"./Line\":4,\"./Overlaps.js\":6,\"./Point\":7,\"./QuadTree\":9}],6:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.quad_and_quad = quad_and_quad;\nexports.quad_and_point = quad_and_point;\nexports.quad_and_circle = quad_and_circle;\nexports.circle_and_circle = circle_and_circle;\nexports.circle_and_point = circle_and_point;\n\nvar _Point = require(\"./Point.js\");\n\nvar _Point2 = _interopRequireDefault(_Point);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction quad_and_quad(a, b) {\n    return a.left <= b.right && a.right >= b.left && a.top <= b.bottom && a.bottom >= b.top;\n}\n\nfunction quad_and_point(q, p) {\n    return p.x >= q.left && p.x <= q.right && p.y >= q.top && p.y <= q.bottom;\n}\n\nfunction quad_and_circle(q, c) {\n    if (quad_and_quad(q, c)) return true;\n    if (c.x >= q.left && c.x <= q.right) return c.y + c.r >= q.top && c.y - c.r <= q.bottom;\n    if (c.y >= q.top && c.y <= q.bottom) return c.x + c.r >= q.left && c.x - c.r <= q.right;\n    var r2 = Math.pow(c.r, 2);\n    return _Point2.default.distance_squared(c, q.tl) <= r2 || _Point2.default.distance_squared(c, q.tr) <= r2 || _Point2.default.distance_squared(c, q.bl) <= r2 || _Point2.default.distance_squared(c, q.br) <= r2;\n}\n\nfunction circle_and_circle(a, b) {\n    return _Point2.default.distance_squared(a, b) <= Math.pow(a.r + b.r, 2);\n}\n\nfunction circle_and_point(c, p) {\n    return _Point2.default.distance_squared(c, p) <= Math.pow(c.r, 2);\n}\n\n},{\"./Point.js\":7}],7:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Point = function () {\n    function Point(x, y) {\n        _classCallCheck(this, Point);\n\n        this.x = x;\n        this.y = y;\n    }\n\n    _createClass(Point, null, [{\n        key: \"distance\",\n        value: function distance(p1, p2) {\n            return Math.sqrt(Point.distance_squared(p1, p2));\n        }\n    }, {\n        key: \"distance_squared\",\n        value: function distance_squared(p1, p2) {\n            return Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2);\n        }\n    }, {\n        key: \"normalize\",\n        value: function normalize(p) {\n            var length = Math.sqrt(p.x * p.x + p.y * p.y);\n            return new Point(p.x / length, p.y / length);\n        }\n    }, {\n        key: \"dot\",\n        value: function dot(p1, p2) {\n            return p1.x * p2.x + p1.y * p2.y;\n        }\n    }, {\n        key: \"scale\",\n        value: function scale(p, v) {\n            return new Point(p.x * v, p.y * v);\n        }\n    }, {\n        key: \"add\",\n        value: function add(p1, p2) {\n            return new Point(p1.x + p2.x, p1.y + p2.y);\n        }\n    }, {\n        key: \"subtract\",\n        value: function subtract(p1, p2) {\n            return new Point(p1.x - p2.x, p1.y - p2.y);\n        }\n    }]);\n\n    return Point;\n}();\n\nexports.default = Point;\n\n},{}],8:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Point = require(\"./Point.js\");\n\nvar _Point2 = _interopRequireDefault(_Point);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Quad = function () {\n    function Quad(x, y, width, height) {\n        _classCallCheck(this, Quad);\n\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n    }\n\n    _createClass(Quad, [{\n        key: \"left\",\n        get: function get() {\n            return this.x;\n        }\n    }, {\n        key: \"top\",\n        get: function get() {\n            return this.y;\n        }\n    }, {\n        key: \"right\",\n        get: function get() {\n            return this.x + this.width;\n        }\n    }, {\n        key: \"bottom\",\n        get: function get() {\n            return this.y + this.height;\n        }\n    }, {\n        key: \"tl\",\n        get: function get() {\n            return new _Point2.default(this.left, this.top);\n        }\n    }, {\n        key: \"tr\",\n        get: function get() {\n            return new _Point2.default(this.right, this.top);\n        }\n    }, {\n        key: \"bl\",\n        get: function get() {\n            return new _Point2.default(this.left, this.bottom);\n        }\n    }, {\n        key: \"br\",\n        get: function get() {\n            return new _Point2.default(this.right, this.bottom);\n        }\n    }, {\n        key: \"points\",\n        get: function get() {\n            return [this.tl, this.tr, this.br, this.bl];\n        }\n    }]);\n\n    return Quad;\n}();\n\nexports.default = Quad;\n\n},{\"./Point.js\":7}],9:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Quad2 = require(\"./Quad.js\");\n\nvar _Quad3 = _interopRequireDefault(_Quad2);\n\nvar _Overlaps = require(\"./Overlaps.js\");\n\nvar Overlaps = _interopRequireWildcard(_Overlaps);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar QuadTree = function (_Quad) {\n    _inherits(QuadTree, _Quad);\n\n    function QuadTree() {\n        var x = arguments.length <= 0 || arguments[0] === undefined ? 0 : arguments[0];\n        var y = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n        var size = arguments.length <= 2 || arguments[2] === undefined ? 400 : arguments[2];\n        var capacity = arguments.length <= 3 || arguments[3] === undefined ? 2 : arguments[3];\n        var max_levels = arguments.length <= 4 || arguments[4] === undefined ? 8 : arguments[4];\n\n        _classCallCheck(this, QuadTree);\n\n        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(QuadTree).call(this, x, y, size, size));\n\n        _this.size = size;\n        _this.capacity = capacity;\n        _this.max_levels = max_levels;\n        _this.my_things = new Set();\n        _this.children = null;\n        _this.all_things = new Set();\n        return _this;\n    }\n\n    _createClass(QuadTree, [{\n        key: \"touch_things\",\n        value: function touch_things() {\n            if (this.my_things) {\n                this.my_things.forEach(function (thing) {\n                    return thing.touch();\n                });\n            }\n        }\n    }, {\n        key: \"add\",\n        value: function add(thing) {\n            if (!Overlaps.quad_and_circle(this, thing)) return false;\n\n            if (this.all_things.has(thing)) return false;else this.all_things.add(thing);\n\n            if (this.my_things) {\n                if (this.my_things.size < this.capacity || !this.max_levels) {\n                    this.my_things.add(thing);\n                    thing.add(this);\n                    this.touch_things();\n                    return true;\n                }\n                this.split();\n            }\n            this.children.forEach(function (child) {\n                return child.add(thing);\n            });\n            return true;\n        }\n    }, {\n        key: \"remove\",\n        value: function remove(thing) {\n            var _this2 = this;\n\n            if (!this.all_things.delete(thing)) return false;\n\n            if (this.my_things) {\n                this.my_things.delete(thing);\n                thing.delete(this);\n                this.touch_things();\n            } else {\n                var remove_from_children = function remove_from_children(thing) {\n                    _this2.children.forEach(function (child) {\n                        return child.remove(thing);\n                    });\n                };\n                remove_from_children(thing);\n                if (this.all_things.size <= this.capacity) {\n                    this.all_things.forEach(remove_from_children);\n                    delete this.children;\n                    this.my_things = new Set();\n\n                    this.all_things.forEach(function (thing) {\n                        _this2.my_things.add(thing);\n                        thing.add(_this2);\n                    });\n                    this.touch_things();\n                }\n            }\n            return true;\n        }\n    }, {\n        key: \"get_thing_at\",\n        value: function get_thing_at(x, y) {\n            var p = { x: x, y: y };\n            var found_thing = null;\n            if (!Overlaps.quad_and_point(this, p)) return null;\n            if (this.my_things) {\n                this.my_things.forEach(function (thing) {\n                    if (Overlaps.circle_and_point(thing, p)) found_thing = thing;\n                });\n                return found_thing;\n            }\n            this.children.forEach(function (child) {\n                return found_thing = found_thing || child.get_thing_at(x, y);\n            });\n            return found_thing;\n        }\n    }, {\n        key: \"split\",\n        value: function split() {\n            var _this3 = this;\n\n            this.my_things.forEach(function (thing) {\n                return thing.delete(_this3);\n            });\n            var half_size = this.size / 2;\n            this.children = [];\n\n            var _loop = function _loop(i) {\n                var x = i % 2;\n                var y = i / 2 >>> 0;\n                var qt = new QuadTree(_this3.x + half_size * x, _this3.y + half_size * y, half_size, _this3.capacity, _this3.max_levels - 1);\n                _this3.children[i] = qt;\n                _this3.my_things.forEach(function (thing) {\n                    return qt.add(thing);\n                });\n            };\n\n            for (var i = 0; i < 4; i++) {\n                _loop(i);\n            }\n            delete this.my_things;\n        }\n    }]);\n\n    return QuadTree;\n}(_Quad3.default);\n\nexports.default = QuadTree;\n\n},{\"./Overlaps.js\":6,\"./Quad.js\":8}],10:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _Thing2 = require(\"./Thing.js\");\n\nvar _Thing3 = _interopRequireDefault(_Thing2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar RoundThing = function (_Thing) {\n    _inherits(RoundThing, _Thing);\n\n    function RoundThing(t, r, x, y, dx, dy) {\n        var ddx = arguments.length <= 6 || arguments[6] === undefined ? 0 : arguments[6];\n        var ddy = arguments.length <= 7 || arguments[7] === undefined ? 0.00001 : arguments[7];\n        var color = arguments.length <= 8 || arguments[8] === undefined ? \"black\" : arguments[8];\n\n        _classCallCheck(this, RoundThing);\n\n        t = t === undefined ? Date.now() : t;\n\n        var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(RoundThing).call(this, t, x, y, dx, dy, ddx, ddy));\n\n        _this.r = r;\n        _this.color = color;\n        return _this;\n    }\n\n    _createClass(RoundThing, [{\n        key: \"clone_at_t\",\n        value: function clone_at_t(t) {\n            var c = _get(Object.getPrototypeOf(RoundThing.prototype), \"clone_at_t\", this).call(this, t);\n            var clone = new RoundThing(t, this.r, c.x, c.y, c.dx, c.dy, c.ddx, c.ddy, this.color);\n            clone.quads_set = new Set(this.quads_set);\n            return clone;\n        }\n    }, {\n        key: \"left\",\n        get: function get() {\n            return this.x - this.r;\n        }\n    }, {\n        key: \"top\",\n        get: function get() {\n            return this.y - this.r;\n        }\n    }, {\n        key: \"right\",\n        get: function get() {\n            return this.x + this.r;\n        }\n    }, {\n        key: \"bottom\",\n        get: function get() {\n            return this.y + this.r;\n        }\n    }], [{\n        key: \"random\",\n        value: function random(t, w, h, x, y) {\n            t = t === undefined ? Date.now() : t;\n            w = w === undefined ? 400 : w;\n            h = h === undefined ? 300 : h;\n\n            var r = Math.random() * 5 + 5;\n            x = x === undefined ? (0.45 + 0.1 * Math.random()) * (w - 2 * r) + r : x;\n            y = y === undefined ? Math.random() * (h - 2 * r) + r : y;\n            var angle = Math.random() * 2 * Math.PI;\n            var speed = (Math.random() * 5 + 2) * 0.01;\n            var dx = Math.cos(angle) * speed;\n            var dy = Math.sin(angle) * speed;\n            var angle2 = Math.random() * 2 * Math.PI;\n            var acceleration = 0.00005;\n            var ddx = Math.cos(angle2) * acceleration;\n            var ddy = Math.sin(angle2) * acceleration;\n            return new RoundThing(t, r, x, y, dx, dy, ddx, ddy);\n        }\n    }]);\n\n    return RoundThing;\n}(_Thing3.default);\n\nexports.default = RoundThing;\n\n},{\"./Thing.js\":11}],11:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Thing = function () {\n    function Thing(t) {\n        var x = arguments.length <= 1 || arguments[1] === undefined ? 0 : arguments[1];\n        var y = arguments.length <= 2 || arguments[2] === undefined ? 0 : arguments[2];\n        var dx = arguments.length <= 3 || arguments[3] === undefined ? 0 : arguments[3];\n        var dy = arguments.length <= 4 || arguments[4] === undefined ? 0 : arguments[4];\n        var ddx = arguments.length <= 5 || arguments[5] === undefined ? 0 : arguments[5];\n        var ddy = arguments.length <= 6 || arguments[6] === undefined ? 0 : arguments[6];\n\n        _classCallCheck(this, Thing);\n\n        this.t = t === undefined ? Date.now() : t;\n        this.x = x;\n        this.y = y;\n        this.dx = dx;\n        this.dy = dy;\n        this.ddx = ddx;\n        this.ddy = ddy;\n        this.quads_set = new Set();\n    }\n\n    _createClass(Thing, [{\n        key: \"add\",\n        value: function add(quad) {\n            return this.quads_set.add(quad);\n        }\n    }, {\n        key: \"delete\",\n        value: function _delete(quad) {\n            return this.quads_set.delete(quad);\n        }\n    }, {\n        key: \"clone_at_t\",\n        value: function clone_at_t(t) {\n            var dt = t - this.t;\n            var dt2 = dt * dt;\n            return new Thing(t, this.x + dt * this.dx + dt2 * this.ddx / 2, this.y + dt * this.dy + dt2 * this.ddy / 2, this.dx + dt * this.ddx, this.dy + dt * this.ddy, this.ddx, this.ddy);\n        }\n    }, {\n        key: \"touch\",\n        value: function touch() {\n            if (this.touched) return;\n\n            var color_cycle = [\"red\",\n            //\"orange\",\n            //\"yellow\",\n            \"lime\", \"aqua\", \"blue\", \"fuchsia\"];\n\n            if (this.color_index === undefined) {\n                this.color_index = Math.floor(Math.random() * color_cycle.length);\n            } else {\n                this.color_index += 3;\n                this.color_index %= color_cycle.length;\n            }\n            this.color = color_cycle[this.color_index];\n            this.touched = true;\n        }\n    }, {\n        key: \"untouch\",\n        value: function untouch() {\n            this.touched = false;\n        }\n    }]);\n\n    return Thing;\n}();\n\nexports.default = Thing;\n\n},{}],12:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.emitter = exports.MOVE = undefined;\n\nvar _ref, _, _2, _atrig2;\n\nexports.calculate_arrow = calculate_arrow;\n\nvar _events = require(\"events\");\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _KeyboardControl = require(\"./KeyboardControl.js\");\n\nvar KeyboardControl = _interopRequireWildcard(_KeyboardControl);\n\nvar _MouseControl = require(\"./MouseControl.js\");\n\nvar MouseControl = _interopRequireWildcard(_MouseControl);\n\nvar _MouseLock = require(\"./MouseLock.js\");\n\nvar MouseLock = _interopRequireWildcard(_MouseLock);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar MOVE = exports.MOVE = \"move\";\nvar emitter = exports.emitter = new _events2.default();\n\n/*********** I guess we're using turn/8 as our angle unit\n * 5  6  7 *\n *  \\ | /  *\n *   \\|/   *\n * 4-- --0 *\n *   /|\\   *\n *  / | \\  *\n * 3  2  1 *\n ***********/\n\nvar _trig = {\n    0: { x: 1, y: 0 },\n    1: { x: Math.SQRT1_2, y: Math.SQRT1_2 },\n    2: { x: 0, y: 1 },\n    3: { x: -Math.SQRT1_2, y: Math.SQRT1_2 },\n    4: { x: -1, y: 0 },\n    5: { x: -Math.SQRT1_2, y: -Math.SQRT1_2 },\n    6: { x: 0, y: -1 },\n    7: { x: Math.SQRT1_2, y: -Math.SQRT1_2 }\n};\n\nvar _atrig = (_atrig2 = {}, _defineProperty(_atrig2, -1, (_ref = {}, _defineProperty(_ref, -1, 5), _defineProperty(_ref, 0, 6), _defineProperty(_ref, 1, 7), _ref)), _defineProperty(_atrig2, 0, (_ = {}, _defineProperty(_, -1, 4), _defineProperty(_, 0, null), _defineProperty(_, 1, 0), _)), _defineProperty(_atrig2, 1, (_2 = {}, _defineProperty(_2, -1, 3), _defineProperty(_2, 0, 2), _defineProperty(_2, 1, 1), _2)), _atrig2);\n\nvar _locked = false;\nvar _micro_angle = 0;\nvar mangle = _trig[0];\nvar kangle = { x: 0, y: 0 };\n\nfunction calculate_arrow(p) {\n    if (p.y < 0) {\n        if (p.x < 0) return \"↖\";\n        if (p.x > 0) return \"↗\";\n        return \"↑\";\n    }\n    if (p.y > 0) {\n        if (p.x < 0) return \"↙\";\n        if (p.x > 0) return \"↘\";\n        return \"↓\";\n    }\n    if (p.x < 0) return \"←\";\n    if (p.x > 0) return \"→\";\n    return \"·\";\n}\n\nKeyboardControl.emitter.on(KeyboardControl.CHORD, function (chord, ts) {\n    var x = 0;\n    var y = 0;\n    var left = +(chord.has(37) || chord.has(65));\n    var up = +(chord.has(38) || chord.has(87));\n    var right = +(chord.has(39) || chord.has(68));\n    var down = +(chord.has(40) || chord.has(83));\n    if (left ^ right) {\n        if (left) x = -1;else x = 1;\n    }\n    if (up ^ down) {\n        if (up) y = -1;else y = 1;\n    }\n    if (x && y) {\n        x *= Math.SQRT1_2;\n        y *= Math.SQRT1_2;\n    }\n    if (x === kangle.x && y === kangle.y) return;\n    kangle = { x: x, y: y };\n    emitter.emit(MOVE, kangle, mangle, ts);\n});\nMouseLock.emitter.on(MouseLock.LOCKED, function (ts) {\n    _locked = true;\n});\nMouseLock.emitter.on(MouseLock.UNLOCKED, function (ts) {\n    _locked = false;\n});\nMouseControl.emitter.on(MouseControl.MOVE, function (dx, dy, ts) {\n    //if (!_locked) return;\n    var r = 320; //just feels about right to me...\n    _micro_angle = ((_micro_angle + dx) % r + r) % r;\n    var angle = _trig[Math.floor(_micro_angle / r * 8)];\n    if (mangle === angle) return;\n    mangle = angle;\n    emitter.emit(MOVE, kangle, mangle, ts);\n});\n\n},{\"./KeyboardControl.js\":13,\"./MouseControl.js\":14,\"./MouseLock.js\":15,\"events\":1}],13:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.emitter = exports.CHORD = undefined;\n\nvar _events = require(\"events\");\n\nvar _events2 = _interopRequireDefault(_events);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _set = new Set();\n\nfunction update_direction(e, state) {\n    var keyCode = (e || window.event).keyCode;\n    if (e.type === \"keyup\") {\n        if (!_set.delete(keyCode)) return;\n    } else if (e.type === \"keydown\") {\n        if (!_set.add(keyCode)) return;\n    }\n    emitter.emit(CHORD, _set, e.timeStamp);\n}\n\nwindow.addEventListener(\"keydown\", update_direction);\nwindow.addEventListener(\"keyup\", update_direction);\n\nvar CHORD = exports.CHORD = \"chord\";\nvar emitter = exports.emitter = new _events2.default();\n\n},{\"events\":1}],14:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.emitter = exports.MOVE = undefined;\n\nvar _events = require(\"events\");\n\nvar _events2 = _interopRequireDefault(_events);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\ndocument.addEventListener(\"mousemove\", function (e) {\n    var dx = e.movementX || e.mozMovementX || 0;\n    var dy = e.movementY || e.mozMovementY || 0;\n    if (dx || dy) emitter.emit(MOVE, dx, dy, e.timeStamp);\n});\n\nvar MOVE = exports.MOVE = \"look\";\nvar emitter = exports.emitter = new _events2.default();\n\n},{\"events\":1}],15:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.emitter = exports.UNLOCKED = exports.LOCKED = exports.unlocked = undefined;\nexports.set = set;\n\nvar _events = require(\"events\");\n\nvar _events2 = _interopRequireDefault(_events);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar unlocked = exports.unlocked = false;\n\nfunction get_pointerLockElement() {\n    return document.pointerLockElement || document.mozPointerLockElement || document.webkitPointerLockElement;\n}\n\nfunction update_pointerlock(e, element) {\n    var pointerLockElement = get_pointerLockElement();\n    if (unlocked !== pointerLockElement) return;\n    exports.unlocked = unlocked = !pointerLockElement;\n    emitter.emit(unlocked ? UNLOCKED : LOCKED, e.timeStamp);\n}\n\nfunction set(element) {\n    var event_name = \"pointerlockchange\";\n    if (\"onmozpointerlockchange\" in document) event_name = \"mozpointerlockchange\";else if (\"onwebkitpointerlockchange\" in document) event_name = \"webkitpointerlockchange\";\n    document.addEventListener(event_name, function (e) {\n        return update_pointerlock(e, element);\n    });\n    element.addEventListener(\"click\", function (e) {\n        return element.requestPointerLock();\n    });\n}\n\nvar LOCKED = exports.LOCKED = \"locked\";\nvar UNLOCKED = exports.UNLOCKED = \"unlocked\";\nvar emitter = exports.emitter = new _events2.default();\n\n},{\"events\":1}],16:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nexports.default = function (element, board) {\n    element.addEventListener(\"click\", function (e) {\n        var p = board.reverse_map(e.x, e.y);\n        var thing = _World.movingThings.get_thing_at(p.x, p.y);\n        if (thing) {\n            _World.movingThings.remove(thing);\n        } else {\n            _World.movingThings.add(_RoundThing2.default.random(Date.now(), 400, 300, p.x, p.y));\n        }\n    });\n    window.addEventListener(\"mousemove\", function (e) {\n        var p = board.reverse_map(e.x, e.y);\n        _World.movingThings.thing = _World.movingThings.get_thing_at_t(p.x, p.y, Date.now());\n    });\n};\n\nvar _World = require(\"../model/World.js\");\n\nvar _RoundThing = require(\"../RoundThing.js\");\n\nvar _RoundThing2 = _interopRequireDefault(_RoundThing);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n},{\"../RoundThing.js\":10,\"../model/World.js\":18}],17:[function(require,module,exports){\n\"use strict\";\n\nvar _Board = require(\"./view/Board.js\");\n\nvar _Board2 = _interopRequireDefault(_Board);\n\nvar _MouseLock = require(\"./controller/MouseLock.js\");\n\nvar _QuadTreeDebug = require(\"./controller/QuadTreeDebug.js\");\n\nvar _QuadTreeDebug2 = _interopRequireDefault(_QuadTreeDebug);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nwindow.onload = function () {\n    var _canvas = document.createElement(\"canvas\");\n    if (!_canvas.getContext) window.alert(\"no getContext...\"); //catastrophic failure\n    document.body.appendChild(_canvas);\n    var _board = new _Board2.default(_canvas.getContext(\"2d\"));\n\n    function handle_resize() {\n        _canvas.width = window.innerWidth;\n        _canvas.height = window.innerHeight;\n        _board.resize(window.innerWidth, window.innerHeight);\n    }\n    window.addEventListener(\"resize\", handle_resize);\n    handle_resize();\n\n    //setMouseLock(_canvas);\n    (0, _QuadTreeDebug2.default)(_canvas, _board);\n};\n\n},{\"./controller/MouseLock.js\":15,\"./controller/QuadTreeDebug.js\":16,\"./view/Board.js\":19}],18:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.movingThings = undefined;\n\nvar _RoundThing = require(\"../RoundThing.js\");\n\nvar _RoundThing2 = _interopRequireDefault(_RoundThing);\n\nvar _MovingThings = require(\"../MovingThings.js\");\n\nvar _MovingThings2 = _interopRequireDefault(_MovingThings);\n\nvar _DoubleJoystick = require(\"../controller/DoubleJoystick.js\");\n\nvar DoubleJoystick = _interopRequireWildcard(_DoubleJoystick);\n\nvar _Overlaps = require(\"../Overlaps.js\");\n\nvar Overlaps = _interopRequireWildcard(_Overlaps);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nDoubleJoystick.emitter.on(DoubleJoystick.MOVE, function (k, m, ts) {\n    console.log(DoubleJoystick.calculate_arrow(k), DoubleJoystick.calculate_arrow(m), ts);\n});\n\nvar w = 400;\nvar h = 300;\nvar t = Date.now();\nvar movingThings = exports.movingThings = new _MovingThings2.default(t, 0, 0, w, h);\n\nfor (var i = 0; i < 30; i++) {\n    var thing = _RoundThing2.default.random(t, w, h);\n    var no_collision = true;\n    /*\n    movingThings.things_set.forEach(thing2 => {\n        if (Overlaps.circle_and_circle(thing, thing2)) {\n            no_collision = false;\n        }\n    });\n    */\n    if (no_collision) movingThings.add(thing);\n}\n\n},{\"../MovingThings.js\":5,\"../Overlaps.js\":6,\"../RoundThing.js\":10,\"../controller/DoubleJoystick.js\":12}],19:[function(require,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _World = require(\"../model/World.js\");\n\nvar _Quad = require(\"../Quad.js\");\n\nvar _Quad2 = _interopRequireDefault(_Quad);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar _SCALE = Symbol();\n\nvar last_time = Date.now();\n\nvar Board = function () {\n    function Board(context) {\n        var _this = this;\n\n        var vwidth = arguments.length <= 1 || arguments[1] === undefined ? 400 : arguments[1];\n        var vheight = arguments.length <= 2 || arguments[2] === undefined ? 300 : arguments[2];\n\n        _classCallCheck(this, Board);\n\n        this.context = context;\n        this.vwidth = vwidth; //let's pretend this is the width when talking to Board\n        this.vheight = vheight; //let's pretend this is the height when talking to Board\n        this.inner = new _Quad2.default(0, 0, vwidth, vheight);\n        this[_SCALE] = 1;\n        var redraw_loop = function redraw_loop() {\n            _this.redraw();\n            window.requestAnimationFrame(redraw_loop);\n        };\n        window.requestAnimationFrame(redraw_loop);\n    }\n\n    _createClass(Board, [{\n        key: \"resize\",\n        value: function resize(width, height) {\n            this.windowWidth = width;\n            this.windowHeight = height;\n            //size to fit\n            var inner_ratio = this.vwidth / this.vheight;\n            var outer_ratio = width / height;\n            this.inner.x = 0;\n            this.inner.y = 0;\n            this.inner.width = width;\n            this.inner.height = height;\n            if (outer_ratio > inner_ratio) {\n                //window is too wide;\n                this.inner.width = Math.floor(height * inner_ratio);\n                this.inner.x = Math.floor((width - this.inner.width) / 2);\n            } else {\n                //window is too tall;\n                this.inner.height = Math.floor(width / inner_ratio);\n                this.inner.y = Math.floor((height - this.inner.height) / 2);\n            }\n            this[_SCALE] = this.inner.width / this.vwidth;\n            this.redraw();\n        }\n    }, {\n        key: \"redraw\",\n        value: function redraw() {\n            var _this2 = this;\n\n            last_time = Math.min(last_time + 100, Date.now());\n            var things = _World.movingThings.get_things_at_t(last_time);\n            this.context.clearRect(0, 0, this.windowWidth, this.windowHeight);\n            this.context.lineWidth = 1;\n            var draw_quadtree = function draw_quadtree(quadtree) {\n                if (quadtree.children) {\n                    var middle = _this2.map(quadtree.x + quadtree.size / 2, quadtree.y + quadtree.size / 2);\n                    var tl = _this2.map(quadtree.x, quadtree.y);\n                    var br = _this2.map(quadtree.x + quadtree.size, quadtree.y + quadtree.size);\n                    _this2.context.beginPath();\n                    _this2.context.moveTo(middle.x, tl.y);\n                    _this2.context.lineTo(middle.x, br.y);\n                    _this2.context.moveTo(tl.x, middle.y);\n                    _this2.context.lineTo(br.x, middle.y);\n                    _this2.context.stroke();\n                    quadtree.children.forEach(function (child) {\n                        return draw_quadtree(child);\n                    });\n                }\n            };\n\n            //this.context.strokeStyle = \"rgb(240,240,255)\";\n            this.context.strokeStyle = \"rgb(100,100,255)\";\n            draw_quadtree(_World.movingThings);\n\n            if (_World.movingThings.thing) {\n                this.context.strokeStyle = \"rgb(255,55,55)\";\n                this.context.lineWidth = 2;\n                _World.movingThings.thing.quads_set.forEach(function (quad) {\n                    var tl = _this2.map(quad.x, quad.y);\n                    var size = _this2.scale(quad.size);\n                    _this2.context.strokeRect(tl.x, tl.y, size, size);\n                });\n            }\n\n            this.context.lineWidth = 1;\n            things.forEach(function (thing) {\n                _this2.context.strokeStyle = thing.color || \"green\";\n                thing.untouch();\n                _this2.context.beginPath();\n                var p = _this2.map(thing.x, thing.y);\n                var r = _this2.scale(thing.r);\n                _this2.context.arc(p.x, p.y, r, 0, Math.PI * 2, true);\n                _this2.context.stroke();\n                var neighbors = new Set();\n                thing.quads_set.forEach(function (quad) {\n                    quad.all_things.forEach(function (neighbor) {\n                        if (thing != neighbor) neighbors.add(neighbor);\n                    });\n                });\n                neighbors.forEach(function (neighbor) {\n                    _this2.context.beginPath();\n                    _this2.context.strokeStyle = \"grey\";\n                    var p1 = _this2.map(thing.x, thing.y);\n                    var p2 = _this2.map(neighbor.x, neighbor.y);\n                    _this2.context.moveTo(p1.x, p1.y);\n                    _this2.context.lineTo(p2.x, p2.y);\n                    _this2.context.stroke();\n                });\n            });\n\n            this.context.strokeStyle = \"blue\";\n            this.context.lineWidth = 1;\n            var origin = this.map(0, 0);\n            this.context.strokeStyle = \"black\";\n            this.context.strokeRect(origin.x, origin.y, this.scale(this.vwidth), this.scale(this.vheight));\n            var p = this.map(200, -50);\n            this.context.moveTo(p.x, p.y);\n            p = this.map(400, 150);\n            this.context.lineTo(p.x, p.y);\n            p = this.map(200, 350);\n            this.context.lineTo(p.x, p.y);\n            p = this.map(0, 150);\n            this.context.lineTo(p.x, p.y);\n            p = this.map(200, -50);\n            this.context.lineTo(p.x, p.y);\n            this.context.stroke();\n        }\n    }, {\n        key: \"map\",\n        value: function map(x, y) {\n            return { x: this.inner.x + this.scale(x), y: this.inner.y + this.scale(y) };\n        }\n    }, {\n        key: \"reverse_map\",\n        value: function reverse_map(x, y) {\n            return { x: this.reverse_scale(x - this.inner.x), y: this.reverse_scale(y - this.inner.y) };\n        }\n    }, {\n        key: \"scale\",\n        value: function scale(v) {\n            return this[_SCALE] * v;\n        }\n    }, {\n        key: \"reverse_scale\",\n        value: function reverse_scale(v) {\n            return v / this[_SCALE];\n        }\n    }]);\n\n    return Board;\n}();\n\nexports.default = Board;\n\n},{\"../Quad.js\":8,\"../model/World.js\":18}]},{},[17])\n\n","let _sign = Math.sign || function (x) {\n    return x && x > 0 ? 1 : -1;\n};\n\n\n\n\nclass Complex {\n    constructor (r = 0, i = 0) {\n        this.r = r;\n        this.i = i;\n    }\n\n    abs () {\n        return _abs(this);\n    }\n\n    add (v) {\n        return _add(this, Complex.convert(v));\n    }\n\n    div (v) {\n        return _div(this, Complex.convert(v));\n    }\n\n    mul (v) {\n        return _mul(this, Complex.convert(v));\n    }\n\n    neg () {\n        return _neg(this);\n    }\n\n    sqrt () {\n        return _sqrt(this);\n    }\n\n    sub (v) {\n        return _sub(this, Complex.convert(v));\n    }\n\n\n\n\n    static convert (v, i = 0) { //can also pass r, i\n        if (v) {\n            let type = typeof v;\n            if (type === \"number\") return new Complex(v, i);\n            //no good reason to pass imaginary part at this point\n            if (type === \"object\") return new Complex(\n                typeof v.r === \"number\" ? v.r : parseFloat(v.r) || 0,\n                typeof v.i === \"number\" ? v.i : parseFloat(v.i) || 0\n            );\n        }\n        return new Complex(0, i);\n    }\n\n    static abs (v = 0, i = 0) { //can also pass r, i\n        return _abs(Complex.convert(v, i));\n    }\n\n    static add (a, b) {\n        return _add(Complex.convert(a), Complex.convert(b));\n    }\n\n    static div (a, b) {\n        return _div(Complex.convert(a), Complex.convert(b));\n    }\n\n    static mul (a, b) {\n        return _mul(Complex.convert(a), Complex.convert(b));\n    }\n\n    static neg (v = 0, i = 0) { //can also pass r, i\n        return _neg(Complex.convert(v, i));\n    }\n\n    static sqrt (v = 0, i = 0) { //can also pass r, i\n        return _sqrt(Complex.convert(v, i));\n    }\n\n    static sub (a, b) {\n        return _sub(Complex.convert(a), Complex.convert(b));\n    }\n\n\n\n\n\n\n    //slower, just here for testing\n    static sqrt2 (r = 0, i = 0) {\n        let sqrt_radius = Math.pow(r*r + i*i, 0.25);\n        let half_theta = Math.atan2(i, r) / 2;\n\n        let a = Math.cos(half_theta) * sqrt_radius;\n        let b = Math.sin(half_theta) * sqrt_radius;\n        return new Complex(a, b);\n    }\n}\n\nfunction _abs (v) {\n    return new Complex(Math.sqrt(v.r*v.r + v.i*v.i), 0);\n}\n\nfunction _add (a, b) {\n    return new Complex(a.r + b.r, a.i + b.i);\n}\n\nfunction _div (a, b) {\n    let d = b.r*b.r + b.i*b.i;\n    return new Complex((a.r*b.r + a.i*b.i) / d, (a.i*b.r - a.r*b.i) / d);\n}\n\nfunction _mul (a, b) {\n    return new Complex(a.r * b.r - a.i * b.i, a.r * b.i + a.i * b.r);\n}\n\nfunction _neg (v) {\n    return new Complex(-v.r, -v.i);\n}\n\nfunction _sqrt (v) {\n    if (!v.i) {\n        if (v.r < 0) return new Complex(0, Math.sqrt(-v.r));\n        else return new Complex(Math.sqrt(v.r), 0);\n    }\n    let a = _abs(v).r / 2;\n    let b = v.r / 2;\n    let c = Math.sqrt(a + b);\n    let d = _sign(v.i) * Math.sqrt(a - b);\n    return new Complex(c, d);\n}\n\nfunction _sub (a, b) {\n    return new Complex(a.r - b.r, a.i - b.i);\n}\n\nexport default Complex;\n","\nimport Complex from \"./Complex.js\";\nlet C = Complex.convert;\n\nlet _sign = Math.sign || function (x) {\n    return x && x > 0 ? 1 : -1;\n};\n\nlet _sqrt3 = Math.sqrt(3);\n\nfunction _cube_root(v) {\n    return _sign(v) * Math.pow(Math.abs(v), 1/3);\n}\n\nfunction _linear(a, b, complex) {\n    if (complex) return [C(-b / a)];\n    else return [-b / a];\n}\n\nfunction _quadratic(a, b, c, complex) {\n    // (-b +- sqrt(b^2 - 4ac)) / 2a\n    let d = 2 * a;\n    let e = b * b - 4 * a * c;\n    let f = b / d;\n    let g = Math.sqrt(Math.abs(e)) / d;\n    if (complex) {\n        if (e < 0) return [C(-f, g), C(-f, -g)];\n        return [C(-f - g), C(-f + g)];\n    } else {\n        if (e < 0) return [];\n        return [-f - g, -f + g];\n    }\n}\n\nfunction _cubic(a, b, c, d, complex) {\n    let a2 = a * a;\n    let a3 = a2 * a;\n    let b2 = b * b;\n    let b3 = b2 * b;\n    let f = (3 * c / a - b2 / a2) / 3;\n    let g = (2 * b3 / a3 - 9 * b * c / a2 + 27 * d / a) / 27;\n    let g2 = g * g;\n    let h = g2 / 4 + f * f * f / 27;\n    if (h > 0) {\n        let h1_2 = Math.sqrt(h);\n        let r = -g / 2 + h1_2;\n        let s = _cube_root(r);\n        let t = -g / 2 - h1_2;\n        let u = _cube_root(t);\n        if (complex) {\n            let real = (s + u) / 2 - b / (3 * a);\n            let imaginary = (s - u) * _sqrt3 / 2;\n            return [\n                C(s + u - b / (3 * a)),\n                C(real, imaginary),\n                C(real, -imaginary)\n            ];\n        } else {\n            return [s + u - b / (3 * a)];\n        }\n    } else if (h === 0 && f === 0 && g === 0) {\n        if (complex) return [C(-_cube_root(d / a))];\n        else return [-_cube_root(d / a)];\n    } else {\n        let i = Math.sqrt(g2 / 4 - h);\n        let j = _cube_root(i);\n        let k = Math.acos(-g / (2 * i));\n        let m = Math.cos(k / 3);\n        let n = _sqrt3 * Math.sin(k / 3);\n        let p = -b / (3 * a);\n        if (complex) {\n            return [\n                C(-j * (m - n) + p),\n                C(-j * (m + n) + p),\n                C(2 * j * Math.cos(k / 3) - b / (3 * a))\n            ];\n        } else {\n            return [\n                -j * (m - n) + p,\n                -j * (m + n) + p,\n                2 * j * Math.cos(k / 3) - b / (3 * a)\n            ];\n        }\n    }\n}\n\nfunction _quartic(a, b, c, d, e, complex) {\n    b /= a;\n    c /= a;\n    d /= a;\n    e /= a;\n    let b2 = b * b;\n    let f = c - 3 * b2 / 8;\n    let b3 = b2 * b;\n    let g = d + b3 / 8 - b * c / 2;\n    let b4 = b3 * b;\n    let h = e - 3 * b4 / 256 + b2 * c / 16 -b * d / 4;\n    let y = _cubic(1, f/2, (f*f - 4*h) / 16, -g*g / 64, true);\n    y.sort((a,b) => b.i - a.i || b.r - a.r);\n    let p = y[0].sqrt();\n    let q = y[1].sqrt();\n    let r = C(-g).div(p.mul(q).mul(8));\n    let s = C(b / 4);\n    let x = [\n        p.add(q).add(r).sub(s),\n        p.sub(q).sub(r).sub(s),\n        p.neg().add(q).sub(r).sub(s),\n        p.neg().sub(q).add(r).sub(s)\n    ];\n    if (complex) {\n        return x;\n    } else {\n        return x.filter(v => !v.i).map(v => v.r);\n    }\n}\n\nfunction _solve(coefficients, complex = false) {\n    let co = coefficients.slice();\n    while (co.length && !co[0]) co.shift();\n    let solutions = [];\n    if (!co.length) return solutions;\n    if (!co[co.length - 1]) {\n        if (complex) solutions.push(C(0));\n        else solutions.push(0);\n        while (!co[co.length - 1]) co.pop();\n    }\n    if (co.length < 2) return solutions;\n    let a = co[0];\n    let b = co[1];\n    if (co.length === 2) return _linear(a, b, complex).concat(solutions);\n    let c = co[2];\n    if (co.length === 3) return _quadratic(a, b, c, complex).concat(solutions);\n    let d = co[3];\n    if (co.length === 4) return _cubic(a, b, c, d, complex).concat(solutions);\n    let e = co[4];\n    if (co.length === 5) return _quartic(a, b, c, d, e, complex).concat(solutions);\n\n    return \"unhandled polynomic order\";\n}\n\n\nexport function solve(coefficients, complex = false) {\n    if (complex) return _solve(coefficients, complex).sort((a,b) => a.r - b.r || a.i - b.i);\n    else return _solve(coefficients, complex).sort((a,b) => a - b);\n}\n\nexport function linear (a, b, complex = false) {\n    return solve([a,b], complex);\n}\n\nexport function quadratic(a, b, c, complex = false) {\n    return solve([a,b, c], complex);\n}\n\nexport function cubic(a, b, c, d, complex = false) {\n    return solve([a,b, c, d], complex);\n}\n\nexport function quartic(a, b, c, d, e, complex = false) {\n    return solve([a,b, c, d, e], complex);\n}\n\n","\nimport Point from \"./Point\";\n\nexport default class Line {\n    constructor (p1, p2) {\n        this.p1 = p1;\n        this.p2 = p2;\n    }\n\n    static get_normals (line) {\n        let dx = line.p2.x - line.p1.x;\n        let dy = line.p2.y - line.p1.y;\n        return [\n            {x: -dy, y:  dx}, //right side first\n            {x:  dy, y: -dx}\n        ];\n    }\n}\n","\nimport QuadTree from \"./QuadTree\";\nimport {solve} from \"./EquationSolver\";\nimport Point from \"./Point\";\nimport Line from \"./Line\";\nimport * as Overlaps from \"./Overlaps.js\";\n\nlet _collisions_by_things = new Map();\n\nfunction points_to_lines(points) {\n    let lines = [];\n    points.forEach((p1, i1) => {\n        let i2 = (i1 + 1) % points.length;\n        let p2 = points[i2];\n        lines.push(new Line(p1, p2));\n    });\n    return lines;\n}\n\nlet box = [\n    {x:  -0.1, y:  -0.1},\n    {x: 400.1, y:  -0.1},\n    {x: 400.1, y: 300.1},\n    {x:  -0.1, y: 300.1}\n];\nbox = points_to_lines(box);\nlet diamond = [\n    {x: 200, y: -50},\n    {x: 400, y: 150},\n    {x: 200, y: 350},\n    {x:   0, y: 150}\n];\ndiamond = points_to_lines(diamond);\n\nfunction predict_collisions(thing, shape) {\n    var collisions = [];\n    shape.forEach(line => {\n        let n = Point.normalize(Line.get_normals(line)[0]);\n        let n_dot_p = Point.dot(n, new Point(thing.x - line.p1.x, thing.y - line.p1.y));\n        if (n_dot_p < 0) return;\n        \n        let coefficients = [\n            Point.dot(n, new Point(thing.ddx, thing.ddy)) / 2,\n            Point.dot(n, new Point(thing.dx, thing.dy)),\n            n_dot_p - thing.r\n        ];\n        let dts = solve(coefficients);\n        dts.forEach(dt => {\n            if (dt <= 0) return;\n            collisions.push({\n                thing: thing,\n                normal: n,\n                t: thing.t + dt\n            });\n        });\n    });\n    return collisions;\n}\n\nfunction predict_collisions2(thing, shape) {\n    var collisions = [];\n    shape.forEach(line => {\n        let n = Point.normalize(Line.get_normals(line)[0]);\n        let n_dot_p = Point.dot(n, new Point(thing.x - line.p1.x, thing.y - line.p1.y));\n        //if (n_dot_p < 0) return;\n        \n        let ddz = Point.dot(n, new Point(thing.ddx, thing.ddy)) / 2;\n        let dz = Point.dot(n, new Point(thing.dx, thing.dy));\n        let dts = [].concat(\n            solve([ddz, dz, n_dot_p - thing.r]),\n            solve([ddz, dz, n_dot_p + thing.r]));\n        dts.forEach(dt => {\n            if (dt <= 0) return;\n            collisions.push({\n                thing: thing,\n                normal: n,\n                t: thing.t + dt\n            });\n        });\n    });\n    return collisions;\n}\n\nfunction predict_quad_collisions(thing) {\n    var collisions = [];\n    thing.quads_set.forEach(quad => {\n        let shape = points_to_lines(quad.points);\n        let naive_collisions = predict_collisions2(thing, shape);\n        naive_collisions.forEach(c => delete c.normal);\n        collisions = collisions.concat(naive_collisions);\n    });\n    return collisions;\n}\n\nfunction _predict_all_collisions(thing) {\n    let room_collisions = predict_collisions(thing, box);\n    let diamond_collisions = predict_collisions(thing, diamond);\n    let quad_collisions = predict_quad_collisions(thing);\n    return [].concat(room_collisions, diamond_collisions, quad_collisions);\n}\n\nexport default class MovingThings extends QuadTree {\n    constructor (t, x = 0, y = 0, width = 400, height = 300, capacity = 2, max_levels = 5) {\n        super (x, y, Math.max(width, height), capacity, max_levels);\n        this.t = t === undefined ? Date.now() : t;\n        this.court_width = width;\n        this.court_height = height;\n        this.collisions = [];\n    }\n\n    get_things_at_t (t) {\n        while (this.collisions.length && this.collisions[0].t < t) {\n            let next_collision = this.collisions.shift();\n            let n = next_collision.normal;\n            this.remove(next_collision.thing);\n            let thing = next_collision.thing.clone_at_t(next_collision.t);\n            if (n) {\n                let v = new Point(thing.dx, thing.dy);\n                let v_dot_n = Point.dot(v, n);\n                let r = Point.add(Point.scale(n, v_dot_n * -2), v);\n                thing.dy = r.y;\n                thing.dx = r.x;\n            }\n            super.add(thing);\n            if (this.thing === next_collision.thing) \n                this.thing = thing;\n            this.collisions = this.collisions.filter(collision => {\n                return collision.thing !== next_collision.thing;\n            });\n            let all_collisions = _predict_all_collisions(thing);\n            all_collisions = all_collisions.filter(collision => {\n                return collision.t > next_collision.t;\n            });\n            this.collisions = this.collisions.concat(all_collisions);\n            this.collisions.sort((a,b) => a.t - b.t);\n        }\n        this.t = t;\n        /*\n        let temp = Array.from(this.all_things);\n        temp.forEach(thing => this.remove(thing));\n        this.collisions = [];\n        temp.forEach(thing => this.add(thing.clone_at_t(t)));\n        */\n        return Array.from(this.all_things).map(thing => thing.clone_at_t(t));\n    }\n\n    add (thing) {\n        if (!super.add(thing)) return false;\n        let all_collisions = _predict_all_collisions(thing);\n        this.collisions = this.collisions.concat(all_collisions);\n        this.collisions.sort((a,b) => a.t - b.t);\n        return true;\n    }\n\n    get_thing_at_t (x, y, t) {\n        let p = {x:x, y:y};\n        let found_thing = null;\n        if (!Overlaps.quad_and_point(this, p)) return null;\n        if (this.my_things) {\n            this.my_things.forEach(thing => {\n                let thing_now = thing.clone_at_t(t);\n                if (Overlaps.circle_and_point(thing_now, p)) found_thing = thing;\n            });\n            return found_thing;\n        }\n        this.children.forEach(child => found_thing = found_thing || child.get_thing_at(x, y));\n        return found_thing;\n    }\n}\n","import Point from \"./Point.js\";\n\nexport function quad_and_quad(a, b) {\n    return  a.left      <= b.right && \n            a.right     >= b.left &&\n            a.top       <= b.bottom &&\n            a.bottom    >= b.top;\n}\n\nexport function quad_and_point(q, p) {\n    return  p.x >= q.left &&\n            p.x <= q.right &&\n            p.y >= q.top &&\n            p.y <= q.bottom;\n}\n\nexport function quad_and_circle(q, c) {\n    if (quad_and_quad(q, c)) return true;\n    if (c.x >= q.left && c.x <= q.right)\n        return c.y + c.r >= q.top && c.y - c.r <= q.bottom;\n    if (c.y >= q.top && c.y <= q.bottom)\n        return c.x + c.r >= q.left && c.x - c.r <= q.right;\n    let r2 = Math.pow(c.r, 2);\n    return  Point.distance_squared(c, q.tl) <= r2 ||\n            Point.distance_squared(c, q.tr) <= r2 ||\n            Point.distance_squared(c, q.bl) <= r2 ||\n            Point.distance_squared(c, q.br) <= r2;\n}\n\nexport function circle_and_circle(a, b) {\n    return Point.distance_squared(a, b) <= Math.pow(a.r + b.r, 2);\n}\n\nexport function circle_and_point(c, p) {\n    return Point.distance_squared(c, p) <= Math.pow(c.r, 2);\n}\n","\nexport default class Point {\n    constructor (x, y) {\n        this.x = x;\n        this.y = y;\n    }\n\n    static distance (p1, p2) {\n        return Math.sqrt(Point.distance_squared(p1, p2));\n    }\n\n    static distance_squared (p1, p2) {\n        return Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2);\n    }\n\n    static normalize (p) {\n        let length = Math.sqrt(p.x * p.x + p.y * p.y);\n        return new Point(p.x / length, p.y / length);\n    }\n\n    static dot (p1, p2) {\n        return p1.x * p2.x + p1.y * p2.y;\n    }\n\n    static scale (p, v) {\n        return new Point(p.x * v, p.y * v);\n    }\n\n    static add (p1, p2) {\n        return new Point(p1.x + p2.x, p1.y + p2.y);\n    }\n\n    static subtract (p1, p2) {\n        return new Point(p1.x - p2.x, p1.y - p2.y);\n    }\n}\n","\nimport Point from \"./Point.js\";\n\nexport default class Quad {\n    constructor (x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n    }\n\n    get left () {\n        return this.x;\n    }\n\n    get top () {\n        return this.y;\n    }\n\n    get right () {\n        return this.x + this.width;\n    }\n\n    get bottom () {\n        return this.y + this.height;\n    }\n\n    get tl () {\n        return new Point(this.left, this.top);\n    }\n\n    get tr () {\n        return new Point(this.right, this.top);\n    }\n\n    get bl () {\n        return new Point(this.left, this.bottom);\n    }\n\n    get br () {\n        return new Point(this.right, this.bottom);\n    }\n\n    get points () {\n        return [this.tl, this.tr, this.br, this.bl];\n    }\n}\n","\nimport Quad from \"./Quad.js\";\nimport * as Overlaps from \"./Overlaps.js\";\n\n\nexport default class QuadTree extends Quad {\n    constructor (x = 0, y = 0, size = 400, capacity = 2, max_levels = 8) {\n        super (x, y, size, size);\n        this.size = size;\n        this.capacity = capacity;\n        this.max_levels = max_levels;\n        this.my_things = new Set();\n        this.children = null;\n        this.all_things = new Set();\n    }\n\n    touch_things () {\n        if (this.my_things) {\n            this.my_things.forEach(thing => thing.touch());\n        }\n    }\n\n    add (thing) {\n        if (!Overlaps.quad_and_circle(this, thing)) return false;\n\n        if (this.all_things.has(thing)) return false;\n        else this.all_things.add(thing);\n\n        if (this.my_things) {\n            if (this.my_things.size < this.capacity || !this.max_levels) {\n                this.my_things.add(thing);\n                thing.add(this);\n                this.touch_things();\n                return true;\n            }\n            this.split();\n        }\n        this.children.forEach(child => child.add(thing));\n        return true;\n    }\n\n    remove (thing) {\n        if (!this.all_things.delete(thing)) return false;\n\n        if (this.my_things) {\n            this.my_things.delete(thing);\n            thing.delete(this);\n            this.touch_things();\n        } else {\n            let remove_from_children = thing => {\n                this.children.forEach(child => child.remove(thing));\n            };\n            remove_from_children(thing);\n            if (this.all_things.size <= this.capacity) {\n                this.all_things.forEach(remove_from_children);\n                delete this.children;\n                this.my_things = new Set();\n\n                this.all_things.forEach(thing => {\n                    this.my_things.add(thing);\n                    thing.add(this);\n                });\n                this.touch_things();\n            }\n        }\n        return true;\n    }\n\n    get_thing_at (x, y) {\n        let p = {x:x, y:y};\n        let found_thing = null;\n        if (!Overlaps.quad_and_point(this, p)) return null;\n        if (this.my_things) {\n            this.my_things.forEach(thing => {\n                if (Overlaps.circle_and_point(thing, p)) found_thing = thing;\n            });\n            return found_thing;\n        }\n        this.children.forEach(child => found_thing = found_thing || child.get_thing_at(x, y));\n        return found_thing;\n    }\n\n    split () {\n        this.my_things.forEach(thing => thing.delete(this));\n        let half_size = this.size / 2;\n        this.children = [];\n        for (let i = 0; i < 4; i++) {\n            let x = i % 2;\n            let y = (i / 2) >>> 0;\n            let qt = new QuadTree(\n                this.x + half_size * x,\n                this.y + half_size * y,\n                half_size,\n                this.capacity,\n                this.max_levels - 1\n            );\n            this.children[i] = qt;\n            this.my_things.forEach(thing => qt.add(thing));\n        }\n        delete this.my_things;\n    }\n}\n","\nimport Thing from \"./Thing.js\";\n\nexport default class RoundThing extends Thing {\n    constructor (t, r, x, y, dx, dy, ddx = 0, ddy = 0.00001, color = \"black\") {\n        t = t === undefined ? Date.now() : t;\n        super(t, x, y, dx, dy, ddx, ddy);\n        this.r = r;\n        this.color = color;\n    }\n\n    get left () {\n        return this.x - this.r;\n    }\n\n    get top () {\n        return this.y - this.r;\n    }\n\n    get right () {\n        return this.x + this.r;\n    }\n\n    get bottom () {\n        return this.y + this.r;\n    }\n\n    clone_at_t(t) {\n        let c = super.clone_at_t(t);\n        let clone = new RoundThing(t, this.r, c.x, c.y, c.dx, c.dy, c.ddx, c.ddy, this.color);\n        clone.quads_set = new Set(this.quads_set);\n        return clone;\n    }\n\n    static random(t, w, h, x, y) {\n        t = t === undefined ? Date.now() : t;\n        w = w === undefined ? 400 : w;\n        h = h === undefined ? 300 : h;\n\n        let r = Math.random() * 5 + 5;\n        x = x === undefined ? (0.45 + 0.1 * Math.random()) * (w - 2 * r) + r : x;\n        y = y === undefined ? Math.random() * (h - 2 * r) + r : y;\n        let angle = Math.random() * 2 * Math.PI;\n        let speed = (Math.random() * 5 + 2) * 0.01;\n        let dx = Math.cos(angle) * speed;\n        let dy = Math.sin(angle) * speed;\n        let angle2 = Math.random() * 2 * Math.PI;\n        let acceleration = 0.00005;\n        let ddx = Math.cos(angle2) * acceleration;\n        let ddy = Math.sin(angle2) * acceleration;\n        return new RoundThing(t, r, x, y, dx, dy, ddx, ddy);\n    }\n}\n","\nexport default class Thing {\n    constructor(t, x = 0, y = 0, dx = 0, dy = 0, ddx = 0, ddy = 0) {\n        this.t = t === undefined ? Date.now() : t;\n        this.x = x;\n        this.y = y;\n        this.dx = dx;\n        this.dy = dy;\n        this.ddx = ddx;\n        this.ddy = ddy;\n        this.quads_set = new Set();\n    }\n\n    add (quad) {\n        return this.quads_set.add(quad);\n    }\n    delete (quad) {\n        return this.quads_set.delete(quad);\n    }\n\n    clone_at_t (t) {\n        let dt = t - this.t;\n        let dt2 = dt * dt;\n        return new Thing(\n                t,\n                this.x + dt * this.dx + dt2 * this.ddx / 2,\n                this.y + dt * this.dy + dt2 * this.ddy / 2,\n                this.dx + dt * this.ddx,\n                this.dy + dt * this.ddy,\n                this.ddx,\n                this.ddy\n        );\n\n    }\n\n    touch () {\n        if (this.touched) return;\n\n        let color_cycle = [\n            \"red\",\n            //\"orange\",\n            //\"yellow\",\n            \"lime\",\n            \"aqua\",\n            \"blue\",\n            \"fuchsia\"\n        ];\n\n        if (this.color_index === undefined) {\n            this.color_index = Math.floor(Math.random() * color_cycle.length);\n        } else {\n            this.color_index += 3;\n            this.color_index %= color_cycle.length;\n        }\n        this.color = color_cycle[this.color_index];\n        this.touched = true;\n    }\n    \n    untouch () {\n        this.touched = false;\n    }\n}\n","\nimport EventEmitter from \"events\";\nimport * as KeyboardControl from \"./KeyboardControl.js\";\nimport * as MouseControl from \"./MouseControl.js\";\nimport * as MouseLock from \"./MouseLock.js\";\n\nexport const MOVE = \"move\";\nexport const emitter = new EventEmitter();\n\n/*********** I guess we're using turn/8 as our angle unit\n * 5  6  7 *\n *  \\ | /  *\n *   \\|/   *\n * 4-- --0 *\n *   /|\\   *\n *  / | \\  *\n * 3  2  1 *\n ***********/\n\nlet _trig = {\n    0:{x: 1,            y: 0           },\n    1:{x: Math.SQRT1_2, y: Math.SQRT1_2},\n    2:{x: 0,            y: 1           },\n    3:{x:-Math.SQRT1_2, y: Math.SQRT1_2},\n    4:{x:-1,            y: 0           },\n    5:{x:-Math.SQRT1_2, y:-Math.SQRT1_2},\n    6:{x: 0,            y:-1           },\n    7:{x: Math.SQRT1_2, y:-Math.SQRT1_2}\n};\n\nlet _atrig = {\n    [-1]:{[-1]:5, [ 0]:6,   [ 1]:7},\n    [ 0]:{[-1]:4, [ 0]:null,[ 1]:0},\n    [ 1]:{[-1]:3, [ 0]:2,   [ 1]:1}\n};\n\n\nlet _locked = false;\nlet _micro_angle = 0;\nlet mangle = _trig[0];\nlet kangle = {x:0, y:0};\n\nexport function calculate_arrow(p) {\n    if (p.y < 0) {\n        if (p.x < 0) return \"↖\";\n        if (p.x > 0) return \"↗\";\n        return \"↑\";\n    }\n    if (p.y > 0) {\n        if (p.x < 0) return \"↙\";\n        if (p.x > 0) return \"↘\";\n        return \"↓\";\n    } \n    if (p.x < 0) return \"←\";\n    if (p.x > 0) return \"→\";\n    return \"·\";\n}\n\nKeyboardControl.emitter.on(KeyboardControl.CHORD, (chord, ts) => {\n    let x = 0;\n    let y = 0;\n    let left = +(chord.has(37) || chord.has(65));\n    let up = +(chord.has(38) || chord.has(87));\n    let right = +(chord.has(39) || chord.has(68));\n    let down = +(chord.has(40) || chord.has(83));\n    if (left ^ right) {\n        if (left) x = -1;\n        else x = 1;\n    }\n    if (up ^ down) {\n        if (up) y = -1;\n        else y = 1;\n    }\n    if (x && y) {\n        x *= Math.SQRT1_2;\n        y *= Math.SQRT1_2;\n    }\n    if (x === kangle.x && y === kangle.y) return;\n    kangle = {x:x, y:y};\n    emitter.emit(MOVE, kangle, mangle, ts);\n});\nMouseLock.emitter.on(MouseLock.LOCKED, ts => {\n    _locked = true;\n});\nMouseLock.emitter.on(MouseLock.UNLOCKED, ts => {\n    _locked = false;\n});\nMouseControl.emitter.on(MouseControl.MOVE, (dx, dy, ts) => {\n    //if (!_locked) return;\n    let r = 320; //just feels about right to me...\n    _micro_angle = ((_micro_angle + dx) % r + r) % r;\n    let angle = _trig[Math.floor(_micro_angle / r * 8)];\n    if (mangle === angle) return;\n    mangle = angle;\n    emitter.emit(MOVE, kangle, mangle, ts);\n});\n\n","import EventEmitter from \"events\";\n\nlet _set = new Set();\n\nfunction update_direction(e, state) {\n    let keyCode = (e || window.event).keyCode;\n    if (e.type === \"keyup\") {\n        if(!_set.delete(keyCode)) return;\n    } else if (e.type === \"keydown\") {\n        if(!_set.add(keyCode)) return;\n    }\n    emitter.emit(CHORD, _set, e.timeStamp);\n}\n\nwindow.addEventListener(\"keydown\", update_direction);\nwindow.addEventListener(\"keyup\", update_direction);\n\nexport const CHORD = \"chord\";\nexport const emitter = new EventEmitter();\n","\nimport EventEmitter from \"events\";\n\ndocument.addEventListener(\"mousemove\", e => {\n    let dx = e.movementX || e.mozMovementX || 0;\n    let dy = e.movementY || e.mozMovementY || 0;\n    if (dx || dy) emitter.emit(MOVE, dx, dy, e.timeStamp);\n});\n\nexport const MOVE = \"look\";\nexport const emitter = new EventEmitter();\n","\nimport EventEmitter from \"events\";\n\nexport let unlocked = false;\n\nfunction get_pointerLockElement() {\n    return document.pointerLockElement || document.mozPointerLockElement || document.webkitPointerLockElement;\n}\n\nfunction update_pointerlock(e, element) {\n    let pointerLockElement = get_pointerLockElement();\n    if (unlocked !== pointerLockElement) return;\n    unlocked = !pointerLockElement;\n    emitter.emit(unlocked ? UNLOCKED : LOCKED, e.timeStamp);\n}\n\n\nexport function set (element) {\n    let event_name = \"pointerlockchange\";\n    if (\"onmozpointerlockchange\" in document) event_name = \"mozpointerlockchange\";\n    else if (\"onwebkitpointerlockchange\" in document) event_name = \"webkitpointerlockchange\";\n    document.addEventListener(event_name, e => update_pointerlock(e, element));\n    element.addEventListener(\"click\", e => element.requestPointerLock());\n}\n\nexport const LOCKED = \"locked\";\nexport const UNLOCKED = \"unlocked\";\nexport const emitter = new EventEmitter();\n","import {movingThings} from \"../model/World.js\";\nimport RoundThing from \"../RoundThing.js\";\n\nexport default function (element, board) {\n    element.addEventListener(\"click\", e => {\n        let p = board.reverse_map(e.x, e.y);\n        let thing = movingThings.get_thing_at(p.x, p.y);\n        if (thing) {\n            movingThings.remove(thing);\n        } else {\n            movingThings.add(RoundThing.random(Date.now(), 400, 300, p.x, p.y));\n        }\n    });\n    window.addEventListener(\"mousemove\", e => {\n        let p = board.reverse_map(e.x, e.y);\n        movingThings.thing = movingThings.get_thing_at_t(p.x, p.y, Date.now());\n    });\n}\n","\nimport Board from \"./view/Board.js\";\nimport {set as setMouseLock} from \"./controller/MouseLock.js\";\nimport QuadTreeDebug from \"./controller/QuadTreeDebug.js\";\n\nwindow.onload = () => {\n    let _canvas = document.createElement(\"canvas\");\n    if (!_canvas.getContext) window.alert (\"no getContext...\");//catastrophic failure\n    document.body.appendChild(_canvas);\n    let _board = new Board(_canvas.getContext(\"2d\"));\n\n    function handle_resize () {\n        _canvas.width = window.innerWidth;\n        _canvas.height = window.innerHeight;\n        _board.resize(window.innerWidth, window.innerHeight);\n    }\n    window.addEventListener(\"resize\", handle_resize);\n    handle_resize();\n\n    //setMouseLock(_canvas);\n    QuadTreeDebug(_canvas, _board);\n};\n\n\n","\nimport RoundThing from \"../RoundThing.js\";\nimport MovingThings from \"../MovingThings.js\";\n\nimport * as DoubleJoystick from \"../controller/DoubleJoystick.js\";\nimport * as Overlaps from \"../Overlaps.js\";\n\nDoubleJoystick.emitter.on(DoubleJoystick.MOVE, (k, m, ts) => {\n    console.log(DoubleJoystick.calculate_arrow(k),\n        DoubleJoystick.calculate_arrow(m), ts);\n});\n\n\n\n\nlet w = 400;\nlet h = 300;\nlet t = Date.now();\nexport let movingThings = new MovingThings(t, 0, 0, w, h);\n\nfor (let i = 0; i < 30; i++) {\n    let thing = RoundThing.random(t, w, h);\n    let no_collision = true;\n    /*\n    movingThings.things_set.forEach(thing2 => {\n        if (Overlaps.circle_and_circle(thing, thing2)) {\n            no_collision = false;\n        }\n    });\n    */\n    if (no_collision) movingThings.add(thing);\n}\n\n","\nimport {movingThings} from \"../model/World.js\";\nimport Quad from \"../Quad.js\";\n\nconst _SCALE = Symbol();\n\nlet last_time = Date.now();\n\nexport default class Board {\n    constructor (context, vwidth = 400, vheight = 300) {\n        this.context = context;\n        this.vwidth = vwidth; //let's pretend this is the width when talking to Board\n        this.vheight = vheight; //let's pretend this is the height when talking to Board\n        this.inner = new Quad(0, 0, vwidth, vheight);\n        this[_SCALE] = 1;\n        let redraw_loop = () => {\n            this.redraw();\n            window.requestAnimationFrame(redraw_loop);\n        };\n        window.requestAnimationFrame(redraw_loop);\n    }\n\n    resize (width, height) {\n        this.windowWidth = width;\n        this.windowHeight = height;\n        //size to fit\n        let inner_ratio = this.vwidth / this.vheight;\n        let outer_ratio = width / height;\n        this.inner.x = 0;\n        this.inner.y = 0;\n        this.inner.width = width;\n        this.inner.height = height;\n        if (outer_ratio > inner_ratio) {\n            //window is too wide;\n            this.inner.width = Math.floor(height * inner_ratio);\n            this.inner.x = Math.floor((width - this.inner.width) / 2);\n        } else {\n            //window is too tall;\n            this.inner.height = Math.floor(width / inner_ratio);\n            this.inner.y = Math.floor((height - this.inner.height) / 2);\n        }\n        this[_SCALE] = this.inner.width / this.vwidth;\n        this.redraw();\n    }\n\n    redraw () {\n        last_time = Math.min(last_time + 100, Date.now());\n        let things = movingThings.get_things_at_t(last_time);\n        this.context.clearRect(0,0,this.windowWidth,this.windowHeight);\n        this.context.lineWidth = 1;\n        let draw_quadtree = (quadtree) => {\n            if (quadtree.children) {\n                let middle = this.map(quadtree.x + quadtree.size / 2, quadtree.y + quadtree.size / 2);\n                let tl = this.map(quadtree.x, quadtree.y);\n                let br = this.map(quadtree.x + quadtree.size, quadtree.y + quadtree.size);\n                this.context.beginPath();\n                this.context.moveTo(middle.x, tl.y);\n                this.context.lineTo(middle.x, br.y);\n                this.context.moveTo(tl.x, middle.y);\n                this.context.lineTo(br.x, middle.y);\n                this.context.stroke();\n                quadtree.children.forEach(child => draw_quadtree(child));\n            }\n        };\n\n        //this.context.strokeStyle = \"rgb(240,240,255)\";\n        this.context.strokeStyle = \"rgb(100,100,255)\";\n        draw_quadtree(movingThings);\n\n        if (movingThings.thing) {\n            this.context.strokeStyle = \"rgb(255,55,55)\";\n            this.context.lineWidth = 2;\n            movingThings.thing.quads_set.forEach(quad => {\n                let tl = this.map(quad.x, quad.y);\n                let size = this.scale(quad.size);\n                this.context.strokeRect(\n                    tl.x, tl.y, size, size \n                );\n            });\n        }\n\n        this.context.lineWidth = 1;\n        things.forEach(thing => {\n            this.context.strokeStyle = thing.color || \"green\";\n            thing.untouch();\n            this.context.beginPath();\n            let p = this.map(thing.x, thing.y);\n            let r = this.scale(thing.r);\n            this.context.arc(p.x, p.y, r, 0, Math.PI*2, true);\n            this.context.stroke();\n            let neighbors = new Set();\n            thing.quads_set.forEach(quad => {\n                quad.all_things.forEach(neighbor => {\n                    if (thing != neighbor) neighbors.add(neighbor);\n                });\n            });\n            neighbors.forEach(neighbor => {\n                this.context.beginPath();\n                this.context.strokeStyle = \"grey\";\n                let p1 = this.map(thing.x, thing.y);\n                let p2 = this.map(neighbor.x, neighbor.y);\n                this.context.moveTo(p1.x, p1.y);\n                this.context.lineTo(p2.x, p2.y);\n                this.context.stroke();\n            });\n        });\n\n        this.context.strokeStyle = \"blue\";\n        this.context.lineWidth = 1;\n        let origin = this.map(0, 0);\n        this.context.strokeStyle = \"black\";\n        this.context.strokeRect(origin.x, origin.y, this.scale(this.vwidth), this.scale(this.vheight));\n        let p = this.map(200, -50);\n        this.context.moveTo(p.x, p.y);\n        p = this.map(400, 150);\n        this.context.lineTo(p.x, p.y);\n        p = this.map(200, 350);\n        this.context.lineTo(p.x, p.y);\n        p = this.map(  0, 150);\n        this.context.lineTo(p.x, p.y);\n        p = this.map(200, -50);\n        this.context.lineTo(p.x, p.y);\n        this.context.stroke();\n    }\n\n    map (x, y) {\n        return {x: this.inner.x + this.scale(x), y: this.inner.y + this.scale(y)};\n    }\n\n    reverse_map (x, y) {\n        return {x: this.reverse_scale(x - this.inner.x), y: this.reverse_scale(y - this.inner.y)};\n    }\n\n    scale (v) {\n        return this[_SCALE] * v;\n    }\n\n    reverse_scale (v) {\n        return v / this[_SCALE];\n    }\n}\n\n"],"sourceRoot":"/source/"}